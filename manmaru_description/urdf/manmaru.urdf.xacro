<?xml version="1.0"?>
<robot name="manmaru" xmlns:xacro="http://ros.org/wiki/xacro">

   <xacro:macro name="wheel" params="prefix x y">
      <link name="${prefix}_wheel">
         <visual>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
               <mesh filename="package://manmaru_description/meshes/wheel.stl" />
            </geometry>
         </visual>
         <collision>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
               <mesh filename="package://manmaru_description/meshes/wheel.stl" />
            </geometry>
         </collision>
         <!-- Mass and inertia matrix are generated by Onshape's mass properties tool -->
         <!-- Material: Polyurethane -->
         <inertial>
            <origin
               xyz="0 0 0"
               rpy="0 0 0" />
            <mass
               value="2.903" />
            <inertia
               ixx="0.058"
               ixy="0"
               ixz="0"
               iyy="0.106"
               iyz="0"
               izz="0.058" />
         </inertial>
      </link>
      <joint name="${prefix}_wheel_joint" type="continuous">
         <origin xyz="${x} ${y} -0.12" rpy="0 0 0"/>
         <axis xyz="0 1 0" rpy="0 0 0" />
         <parent link="classis"/>
         <child link="${prefix}_wheel"/>
      </joint>
      <!-- <gazebo reference="${prefix}_wheel">
         <mu1 value="200.0"/>
         <mu2 value="100.0"/>
         <kp value="1000000.0" />
         <kd value="10.0" />
      </gazebo> -->
   </xacro:macro>

   <link name="base_link" />

   <joint name="base_link_to_chassis" type="fixed">
      <parent link="base_link"/>
      <child link="classis"/>
   </joint>

   <link name="classis">
      <visual>
         <origin xyz="0 0 0" rpy="0 0 0" />
         <geometry>
            <mesh filename="package://manmaru_description/meshes/classis.stl" />
         </geometry>
      </visual>
      <collision>
         <origin xyz="0 0 0" rpy="0 0 0" />
         <geometry>
            <mesh filename="package://manmaru_description/meshes/classis.stl" />
         </geometry>
      </collision>
      <!-- Mass and inertia matrix are generated by Onshape's mass properties tool -->
      <!-- Material: Aluminum -->
      <inertial>
         <origin
            xyz="0 0 0"
            rpy="0 0 0" />
         <mass
            value="15.816" />
         <inertia
            ixx="0.719"
            ixy="-4.801e-5"
            ixz="3.711e-16"
            iyy="1.456"
            iyz="5.022e-5"
            izz="1.735" />
      </inertial>
   </link>

   <!-- Four wheels -->
   <xacro:wheel prefix="left_front"  x="0.4"  y="0.4"/>
   <xacro:wheel prefix="left_rear"   x="-0.4" y="0.4"/>
   <xacro:wheel prefix="right_front" x="0.4"  y="-0.4"/>
   <xacro:wheel prefix="right_rear"  x="-0.4" y="-0.4"/>

   <!-- LiDAR -->
   <xacro:include filename="lidar.urdf.xacro" />

   <!-- Manipulator -->
   <xacro:include filename="manipulator.urdf.xacro" />

   <!-- Gazebo plugins -->
   <xacro:include filename="gazebo.urdf" />

</robot>